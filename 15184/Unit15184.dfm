object Form15184: TForm15184
  Left = 35
  Top = 281
  Width = 1286
  Height = 675
  Caption = #1054#1090#1095#1077#1090#1099' '#1076#1083#1103' '#1086#1090#1076#1077#1083#1072' '#1072#1085#1072#1083#1080#1090#1080#1082#1080' '#1080' '#1087#1083#1072#1085#1080#1088#1086#1074#1072#1085#1080#1103'  Form15184'
  Color = clBtnFace
  Font.Charset = DEFAULT_CHARSET
  Font.Color = clWindowText
  Font.Height = -11
  Font.Name = 'MS Sans Serif'
  Font.Style = []
  FormStyle = fsMDIChild
  OldCreateOrder = False
  Position = poDefault
  Visible = True
  PixelsPerInch = 96
  TextHeight = 13
  object cxPageControl1: TcxPageControl
    Left = 0
    Top = 0
    Width = 1270
    Height = 637
    ActivePage = cxTabSheet1
    Align = alClient
    TabOrder = 0
    ClientRectBottom = 637
    ClientRectRight = 1270
    ClientRectTop = 24
    object cxTabSheet1: TcxTabSheet
      Caption = #1055#1088#1086#1074#1077#1088#1082#1072' '#1082#1086#1088#1086#1073#1086#1074' Ostin'
      ImageIndex = 0
      object Panel1: TPanel
        Left = 0
        Top = 0
        Width = 1270
        Height = 57
        Align = alTop
        BevelOuter = bvNone
        Color = clGradientInactiveCaption
        ParentBackground = False
        TabOrder = 0
        object Shape1: TShape
          Left = 8
          Top = 5
          Width = 481
          Height = 41
          ParentShowHint = False
          Pen.Color = clRed
          Pen.Mode = pmMask
          ShowHint = False
        end
        object cxDateEdit1: TcxDateEdit
          Left = 164
          Top = 15
          Style.Color = 16446703
          TabOrder = 0
          Width = 121
        end
        object cxLabel1: TcxLabel
          Left = 300
          Top = 17
          Caption = ' '#1087#1086
          ParentFont = False
          Style.Font.Charset = DEFAULT_CHARSET
          Style.Font.Color = clWindowText
          Style.Font.Height = -11
          Style.Font.Name = 'MS Sans Serif'
          Style.Font.Style = [fsBold]
          Style.LookAndFeel.SkinName = 'Blue'
          Style.IsFontAssigned = True
          StyleDisabled.LookAndFeel.SkinName = 'Blue'
          StyleFocused.LookAndFeel.SkinName = 'Blue'
          StyleHot.LookAndFeel.SkinName = 'Blue'
        end
        object cxDateEdit2: TcxDateEdit
          Left = 332
          Top = 15
          Style.Color = 16446703
          TabOrder = 2
          Width = 121
        end
        object btnViewBox: TcxButton
          Left = 512
          Top = 4
          Width = 45
          Height = 43
          TabOrder = 3
          OnClick = btnViewBoxClick
          Glyph.Data = {
            36030000424D3603000000000000360000002800000010000000100000000100
            1800000000000003000000000000000000000000000000000000C8C8C8009AD9
            00A9EA00A0E7009AD9C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8
            C8C8C8C8C8C8C8C8C8C8C8C8C800B5E700E3FF00CAFD009DDE009AD9C8C8C8C8
            C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C800A1DC
            00DEF800E6FF00C3F8009AD9C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8
            C8C8C8C8C8C8C8C8C8C8C8C8C8009AD900A1DC00EDFD00E7FF00B4EC009AD9C8
            C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8
            009AD900ADE100F0FD0AE8FF2E97C4009AD9C8C8C8C8C8C8C8C8C8C8C8C8C8C8
            C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8009AD90ABAE5B0BABAC19C9CA4
            878CB68888B48787AE8282AE8282C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8
            C8C8C8C8C8C8009EDCC8A9A9BB9292DAB4B4DBB5B5DEBDBDCA9999B68888AE82
            82C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8AE8282C5A0A0EDC19FF1
            B672EEB67CE8C9C1EEDCDCD4A9A9BB8E8EAE8282C8C8C8C8C8C8C8C8C8C8C8C8
            C8C8C8C8C8C8AE8282E9C7B7FFAF2FFFB236FFB43BFDB645EAC4AEF5EAEAD7AE
            AEBA8E8EAE8282C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C7A4A4EBBDA0FFB745FF
            BE51FFC055FFC157FDC15DECCAB6F4E8E8D4ABABAE8282C8C8C8C8C8C8C8C8C8
            C8C8C8C8C8C8B38989E7C5BEFFB44AFFCA6AFFCC6FFFCD70FFCC6EFCCA77F3E0
            DBE6CACABD9393C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8B68F8FDABDBDECAA69FF
            C96EFFD686FFD787FFD685FFD480F4D5B4F4E6E6C8A2A2C8C8C8C8C8C8C8C8C8
            C8C8C8C8C8C8B99393C3A1A1E1BDB7FCB85BFFD282FFE19DFFE09AFFDD94FBDC
            A7F6EAEAC49D9DC8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8BD9999D6BCBCE9
            C3B1F9BA65FFCB75FFE09CFFE6A7FCE7CAEDE1E1B68D8DC8C8C8C8C8C8C8C8C8
            C8C8C8C8C8C8C8C8C8C8C8C8C09D9DD4B9B9E9CBC5F0C08FFABE68FFD294F1E0
            DABC9797B48B8BC8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C8C2
            A0A0C7A8A8D9C1C1E0C9C9DBC4C4C19F9FBA9494C8C8C8C8C8C8}
          LookAndFeel.SkinName = 'Blue'
        end
        object cxLabel2: TcxLabel
          Left = 52
          Top = 17
          Caption = #1042#1099#1073#1077#1088#1080#1090#1077' '#1076#1077#1085#1100' c'
          ParentFont = False
          Style.Font.Charset = DEFAULT_CHARSET
          Style.Font.Color = clWindowText
          Style.Font.Height = -11
          Style.Font.Name = 'MS Sans Serif'
          Style.Font.Style = [fsBold]
          Style.IsFontAssigned = True
        end
      end
      object Panel2: TPanel
        Left = 0
        Top = 569
        Width = 1270
        Height = 44
        Align = alBottom
        BevelOuter = bvNone
        Color = clGradientInactiveCaption
        ParentBackground = False
        TabOrder = 1
        object btnExport1: TcxButton
          Left = 16
          Top = 5
          Width = 145
          Height = 33
          Caption = #1069#1082#1089#1087#1086#1088#1090' '#1074' Excel'
          Font.Charset = DEFAULT_CHARSET
          Font.Color = clWindowText
          Font.Height = -11
          Font.Name = 'MS Sans Serif'
          Font.Style = [fsBold]
          ParentFont = False
          TabOrder = 0
          OnClick = btnExport1Click
          Glyph.Data = {
            F6000000424DF600000000000000760000002800000010000000100000000100
            0400000000008000000000000000000000001000000000000000000000000000
            80000080000000808000800000008000800080800000C0C0C000808080000000
            FF0000FF000000FFFF00FF000000FF00FF00FFFF0000FFFFFF00777800000000
            000077787777777777707778FFFFFFFFFF707778F7777F777F7022222222227F
            7F702FFFFFFFF2FF7F702F22222222FFFF702F22272222777F702FF27222F2FF
            7F702F27222FF2777F702F722222F2FF7F702F22FF22F2777F702FFFFFFFF2FF
            00002222222222FF8F077778FFFFFFFF80777778888888888777}
          LookAndFeel.SkinName = 'Blue'
        end
      end
      object cxGrid1: TcxGrid
        Left = 0
        Top = 57
        Width = 1270
        Height = 512
        Align = alClient
        TabOrder = 2
        LookAndFeel.SkinName = 'Black'
        object cxGrid1DBTableView1: TcxGridDBTableView
          NavigatorButtons.ConfirmDelete = False
          DataController.DataSource = dsBoxCNT
          DataController.Summary.DefaultGroupSummaryItems = <>
          DataController.Summary.FooterSummaryItems = <
            item
              Format = '0.0'
              Kind = skSum
              Column = cxGrid1DBTableView1ACTUAL_KOR_CHECK
            end
            item
              Format = '0.0'
              Kind = skSum
              Column = cxGrid1DBTableView1ACTUAL_QTE_CHECK
            end
            item
              Format = '0.0'
              Kind = skSum
              Column = cxGrid1DBTableView1ALL_CNT_500
            end
            item
              Format = '0.0'
              Kind = skSum
              Column = cxGrid1DBTableView1ALL_KOR_CHECK
            end
            item
              Format = '0.0'
              Kind = skSum
              Column = cxGrid1DBTableView1ALL_QTE_500
            end
            item
              Format = '0.0'
              Kind = skSum
              Column = cxGrid1DBTableView1ALL_QTE_CHECK
            end
            item
              Format = '0.0'
              Kind = skSum
              Column = cxGrid1DBTableView1CNT_454
            end
            item
              Format = '0.0'
              Kind = skSum
              Column = cxGrid1DBTableView1CNT_456
            end
            item
              Format = '0.0'
              Kind = skSum
              Column = cxGrid1DBTableView1CNT_500
            end
            item
              Format = '0.0'
              Kind = skSum
              Column = cxGrid1DBTableView1QTE_454
            end
            item
              Format = '0.0'
              Kind = skSum
              Column = cxGrid1DBTableView1QTE_456
            end
            item
              Format = '0.0'
              Kind = skSum
              Column = cxGrid1DBTableView1QTE_500
            end>
          DataController.Summary.SummaryGroups = <>
          OptionsView.Footer = True
          object cxGrid1DBTableView1DT: TcxGridDBColumn
            Caption = #1044#1072#1090#1072
            DataBinding.FieldName = 'DT'
          end
          object cxGrid1DBTableView1WEEK: TcxGridDBColumn
            Caption = #1053#1077#1076#1077#1083#1103' '#1075#1086#1076#1072
            DataBinding.FieldName = 'WEEK'
            Width = 46
          end
          object cxGrid1DBTableView1ALL_CNT_500: TcxGridDBColumn
            Caption = #1042#1089#1077#1075#1086' '#1082#1086#1088#1086#1073#1086#1074' '#1082' '#1086#1090#1075#1088#1091#1079#1082#1077' '
            DataBinding.FieldName = 'ALL_CNT_500'
            Width = 114
          end
          object cxGrid1DBTableView1ALL_QTE_500: TcxGridDBColumn
            Caption = #1042#1089#1077#1075#1086' '#1077#1076'. '#1082' '#1086#1090#1075#1088#1091#1079#1082#1077
            DataBinding.FieldName = 'ALL_QTE_500'
            Width = 88
          end
          object cxGrid1DBTableView1CNT_500: TcxGridDBColumn
            Caption = #1054#1090#1075'. '#1074' '#1089#1077#1090#1100'('#1084#1072#1075#1072#1079#1080#1085#1099') - '#1082#1086#1088#1086#1073#1086#1074
            DataBinding.FieldName = 'CNT_500'
            Width = 145
          end
          object cxGrid1DBTableView1CNT_454: TcxGridDBColumn
            Caption = #1054#1090#1087#1088'. '#1085#1072' '#1087#1088#1086#1074#1077#1088#1082#1091', '#1082#1086#1088#1086#1073#1086#1074
            DataBinding.FieldName = 'CNT_454'
            Width = 123
          end
          object cxGrid1DBTableView1QTE_500: TcxGridDBColumn
            Caption = #1054#1090#1075#1088'. '#1074' '#1089#1077#1090#1100'('#1084#1072#1075#1072#1079#1080#1085#1099'),  '#1077#1076'.'
            DataBinding.FieldName = 'QTE_500'
            Width = 149
          end
          object cxGrid1DBTableView1QTE_454: TcxGridDBColumn
            Caption = #1054#1090#1087#1088'. '#1085#1072' '#1087#1088#1086#1074'-'#1082#1091', '#1077#1076'.'
            DataBinding.FieldName = 'QTE_454'
            Width = 116
          end
          object cxGrid1DBTableView1CNT_456: TcxGridDBColumn
            Caption = #1060#1072#1082#1090'. '#1087#1088#1086#1074#1077#1088#1077#1085#1086', '#1082#1086#1088#1086#1073#1086#1074
            DataBinding.FieldName = 'CNT_456'
            Width = 117
          end
          object cxGrid1DBTableView1QTE_456: TcxGridDBColumn
            Caption = #1060#1072#1082#1090'. '#1087#1088#1086#1074#1077#1088#1077#1085#1086', '#1077#1076'.'
            DataBinding.FieldName = 'QTE_456'
            Width = 117
          end
          object cxGrid1DBTableView1ACTUAL_KOR_CHECK: TcxGridDBColumn
            Caption = #1054#1073#1098#1077#1084'('#1087#1088#1086#1074'-'#1085#1086' '#1076#1083#1103' '#1084#1072#1075#1072#1079'. '#1082#1086#1088#1086#1073#1086#1074'), %'
            DataBinding.FieldName = 'ACTUAL_KOR_CHECK'
            Width = 210
          end
          object cxGrid1DBTableView1ACTUAL_QTE_CHECK: TcxGridDBColumn
            Caption = #1054#1073#1098#1077#1084'('#1087#1088#1086#1074'-'#1085#1086' '#1077#1076'. '#1076#1083#1103' '#1084#1072#1075#1072#1079'), %'
            DataBinding.FieldName = 'ACTUAL_QTE_CHECK'
            Width = 174
          end
          object cxGrid1DBTableView1ALL_KOR_CHECK: TcxGridDBColumn
            Caption = #1054#1073#1098#1077#1084'('#1074#1089#1077#1075#1086' '#1087#1088#1086#1074'-'#1085#1086' '#1082#1086#1088#1086#1073#1086#1074'), %'
            DataBinding.FieldName = 'ALL_KOR_CHECK'
            Width = 180
          end
          object cxGrid1DBTableView1ALL_QTE_CHECK: TcxGridDBColumn
            Caption = #1054#1073#1098#1077#1084'('#1074#1089#1077#1075#1086' '#1087#1088#1086#1074'-'#1085#1086' '#1077#1076'.), %'
            DataBinding.FieldName = 'ALL_QTE_CHECK'
            Width = 153
          end
        end
        object cxGrid1Level1: TcxGridLevel
          GridView = cxGrid1DBTableView1
        end
      end
    end
  end
  object orqryBoxCNT: TOraQuery
    Session = DM2.OraSession1
    SQL.Strings = (
      'WITH initial_data AS ('
      '-- 500 '#1087#1086#1076#1075#1086#1090#1086#1074#1083#1077#1085
      '-- 454 '#1085#1072' '#1087#1088#1086#1074#1077#1088#1082#1091
      '-- 456 '#1087#1088#1086#1074#1077#1088#1077#1085
      'SELECT trunc(cd.date_operation) as DT,'
      '       cd.type_date,'
      '       lc.qte_deja_preparee,'
      '       col.id_colis,'
      '       eop.id_client,'
      '       lc.id_produit,'
      '       eop.id_societe'
      '       '
      'FROM entete_op_syn eop'
      '   INNER JOIN colis_syn col'
      '            ON eop.id_op = col.id_op '
      '               AND eop.id_societe = col.id_societe '
      '   INNER JOIN colis_date_syn cd'
      '           ON cd.id_colis = col.id_colis'
      '   INNER JOIN ligne_colisee_syn lc'
      '           ON col.id_colis = lc.id_colis'
      '           AND lc.id_op = eop.id_op'
      '           AND lc.id_societe = eop.id_societe'
      '   INNER JOIN article_e ae '
      '           ON ae.id_produit = lc.id_produit'
      '              AND eop.id_societe = ae.id_societe        '
      '  '
      'WHERE 1 = 1 '
      '      AND lower(ae.ext_trade_mark) like '#39'%o_stin%'#39'  '
      
        '      AND cd.type_date in (454, 456, 500)  --'#1076#1083#1103' '#1086#1073#1083#1077#1075#1095#1077#1085#1080#1103' '#1085#1072#1075#1088 +
        #1091#1079#1082#1080' '#1087#1086#1076#1089#1095#1077#1090#1072'  '
      '      &date_filter                                '
      'UNION'
      'SELECT trunc(cd.date_operation) as DT,'
      '       cd.type_date,'
      '       lc.qte_deja_preparee,'
      '       col.id_colis,'
      '       eop.id_client,'
      '       lc.id_produit,'
      '       eop.id_societe'
      ' '
      'FROM entete_op eop'
      '   INNER JOIN colis col'
      '            ON eop.id_op = col.id_op '
      '               AND eop.id_societe = col.id_societe '
      '   INNER JOIN colis_date cd'
      '           ON cd.id_colis = col.id_colis'
      '   INNER JOIN ligne_colisee lc'
      '           ON col.id_colis = lc.id_colis'
      '           AND lc.id_op = eop.id_op'
      '           AND lc.id_societe = eop.id_societe'
      '   INNER JOIN article_e ae '
      '           ON ae.id_produit = lc.id_produit'
      '              AND eop.id_societe = ae.id_societe'
      ''
      'WHERE 1 = 1 '
      '      AND lower(ae.ext_trade_mark) like '#39'%o_stin%'#39'  '
      
        '      AND cd.type_date in (454, 456, 500)  --'#1076#1083#1103' '#1086#1073#1083#1077#1075#1095#1077#1085#1080#1103' '#1085#1072#1075#1088 +
        #1091#1079#1082#1080' '#1087#1086#1076#1089#1095#1077#1090#1072'  '
      '      &date_filter                               '
      '      '
      '),'
      ''
      'result_tab as ('
      ''
      'SELECT DT,'
      '       SUM(CASE'
      '             WHEN type_date = 500 '
      '             THEN qte_deja_preparee'
      '           END ) AS all_qte_500,'
      '       COUNT( distinct '
      '               CASE'
      '                 WHEN type_date = 500 '
      '                 THEN  id_colis'
      '               END ) all_cnt_500,'
      '       SUM(CASE'
      '             WHEN type_date = 500'
      
        '                  and id_client not in (437, 347, 607, 837, 617,' +
        ' 6127, 847, 857, 8007, 387, 397, 627, 307) '
      '             THEN qte_deja_preparee'
      '           END ) AS qte_500,'
      '       COUNT( distinct '
      '               CASE'
      '                 WHEN type_date = 500'
      
        '                      and id_client not in (437, 347, 607, 837, ' +
        '617, 6127, 847, 857, 8007, 387, 397, 627, 307) '
      '                 THEN  id_colis'
      '               END ) cnt_500,            '
      '       SUM(CASE'
      '             WHEN type_date = 454 '
      
        '                  and id_client not in (437, 347, 607, 837, 617,' +
        ' 6127, 847, 857, 8007, 387, 397, 627, 307)'
      '             THEN qte_deja_preparee'
      '           END) qte_454,'
      '       COUNT( distinct '
      '               CASE'
      '                 WHEN type_date = 454 '
      
        '                      and id_client not in (437, 347, 607, 837, ' +
        '617, 6127, 847, 857, 8007, 387, 397, 627, 307)'
      '                 THEN  id_colis'
      '               END) cnt_454,    '
      '       SUM(CASE'
      '             WHEN type_date = 456 '
      
        '                  and id_client not in (437, 347, 607, 837, 617,' +
        ' 6127, 847, 857, 8007, 387, 397, 627, 307)'
      '             THEN qte_deja_preparee'
      '           END) qte_456,'
      '       COUNT( distinct '
      '               CASE'
      '                 WHEN type_date = 456'
      
        '                      and id_client not in (437, 347, 607, 837, ' +
        '617, 6127, 847, 857, 8007, 387, 397, 627, 307) '
      '                 THEN id_colis'
      '               END ) cnt_456'
      ' From initial_data INIT                           '
      ' GROUP BY DT             '
      ')'
      ''
      'Select  dt,'
      '        TO_CHAR (dt, '#39'iw'#39') as WEEK,'
      '        all_cnt_500,'
      '        all_qte_500,'
      '        cnt_500, -- '#1087#1086#1076#1075#1086#1090#1086#1074#1083#1077#1085
      '        qte_500,'
      '        cnt_454, -- '#1085#1072' '#1087#1088#1086#1074#1077#1088#1082#1091
      '        qte_454,'
      '        cnt_456,  --'#1087#1088#1086#1074#1077#1088#1077#1085
      '        qte_456,'
      
        '        ROUND((cnt_456 / DECODE(cnt_500, 0, 1, cnt_500)) *100, 2' +
        ')  as actual_kor_check, -- "'#1082#1086#1088#1086#1073' '#1092#1072#1082#1090'.'#1087#1088#1086#1074#1077#1088#1077#1085#1086'",'
      
        '        ROUND((qte_456 / DECODE(qte_500, 0, 1, qte_500)) *100, 2' +
        ') as actual_qte_check, -- "'#1077#1076'. '#1092#1072#1082#1090'.'#1087#1088#1086#1074#1077#1088#1077#1085#1086'",'
      
        '        ROUND((cnt_456 / DECODE(all_cnt_500, 0, 1, all_cnt_500))' +
        ' *100, 2) as all_kor_check, -- as "'#1082#1086#1088#1086#1073' '#1074#1089#1077#1075#1086'.'#1087#1088#1086#1074#1077#1088#1077#1085#1086'",'
      
        '        ROUND((qte_456 / DECODE(all_qte_500, 0, 1, all_qte_500))' +
        ' *100, 2) as all_qte_check --"'#1077#1076'. '#1074#1089#1077#1075#1086'.'#1087#1088#1086#1074#1077#1088#1077#1085#1086'"'
      'From result_tab')
    FetchAll = True
    Left = 768
    Top = 32
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'date_start'
      end
      item
        DataType = ftUnknown
        Name = 'date_end'
      end>
    MacroData = <
      item
        Name = 'date_filter'
        Value = 
          'AND TRUNC (cd.date_operation) >=  :date_start              '#13#10'AND' +
          ' TRUNC (cd.date_operation) <= :date_end '
      end>
  end
  object dsBoxCNT: TOraDataSource
    DataSet = orqryBoxCNT
    Left = 832
    Top = 32
  end
end
